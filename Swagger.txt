openapi: 3.0.3
info:
  title: BidVerse
  description: |-
    This is the BidVerse application's Swagger page.
  version: 1.0.0
  
servers:
  - url: https://localhost:8081
tags:
  - name: Auction
    description: "Operations related to auctions"
  - name: User
    description: "User account management"
  - name: Bid
    description: "Operations related to bidding"
  - name: Category
    description: "Auction category management (Auction has a Category)"
  - name: Watch
    description: "Tracking watched auctions"
    
paths:
  /users/me:
    put:
      summary: "Update a user's email and phone number"
      description: "Allows updating only the email address and phone number of a user."
      operationId: "updateUserContact"
      tags:
        - "User"
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/UserBasic"
      responses:
        200:
          description: "User successfully updated"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/UserBasic"
        400:
          description: "Invalid request data"
        404:
          description: "User not found"
          
    delete:
      summary: "Delete a user"
      description: "Removes a user from the system."
      operationId: "deleteUser"
      tags:
        - "User"
      responses:
        204:
          description: "User successfully deleted"
        404:
          description: "User not found"
    get:
      summary: "Get basic user profile (excluding bids, auctions, watches)"
      tags: 
        - "User"
      responses:
        200:
          description: "User's basic information"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/UserBasic"
        404:
          description: "User not found"
  /users/profile:
    get:
      summary: "Get username and password hash by user ID"
      tags:
        - "User"
      responses:
        200:
          description: "User credentials"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/UserCredentials"
        401:
          description: "Unauthorized"
    post:
      summary: "Create a new user"
      description: "Registers a new user in the system."
      operationId: "createUser"
      tags:
        - "User"
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/UserCredentials"
      responses:
        201:
          description: "User successfully created"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/UserBasic"
        400:
          description: "Invalid request data"


components:
  schemas:
    Auction:
      type: object
      properties:
        id:
          type: integer
          format: int64
          description: "The unique identifier of Auctions"
        userId:
          type: integer
          format: int64
          description: "The user who created the Auction"
        categoryId:
          type: integer
          format: int64
          description: "The category of the Auction"
        bids:
          type: array
          items: 
            $ref: "#/components/schemas/Bid"
          description: "The offered Bids for the Auction"
        watchedAuctions:
          type: array
          items:
            $ref: "#/components/schemas/Watch"
          description: "List of users watching this Auction"
        itemName:
          type: string
          maxLength: 50
          description: "Name of the Auction item"
        minimumPrice:
          type: number
          format: double
          description: "Minimum selling price of the item"
        status:
          type: string
          maxLength: 20
          description: "Current status of the Auction (e.g., active, closed)"
        createDate:
          type: string
          format: date-time
          description: "Date and time when the Auction was created"
        expiredDate:
          type: string
          format: date-time
          description: "Date and time when the Auction expires"
        lastBid:
          type: number
          format: double
          nullable: true
          description: "Latest Bid amount, if any"
        description:
          type: string
          description: "Detailed description of the item"
        type:
          type: string
          maxLength: 20
          description: "Type of the Auction (e.g., timed, restarting)"
        extraTime:
          type: string
          format: date-time
          nullable: true
          description: "Extra time added to the auction if it's a restarting one"
        itemState:
          type: string
          maxLength: 20
          description: "State of the item (e.g., new, used)"
        tags:
          type: string
          description: "Keywords associated with the Auction item"
        minStep:
          type: integer
          nullable: true
          description: "Minimum increment step for Bids"
    User:
      type: object
      properties:
        id: 
          type: integer
          format: int64
          description: "The unique identifier of Users"
        auctions:
          type: array
          items:
            $ref: "#/components/schemas/Auction"
          description: "List of Auctions, the User is taking part in"
        bids:
          type: array
          items:
            $ref: "#/components/schemas/Bid"
          description: "List of Bids the User has offered"
        watches:
          type: array
          items:
            $ref: "#/components/schemas/Watch"
          description: "List of Auctions watched by the User"
        userName:
          type: string
          maxLength: 25
          description: "The name of the User"
        passwordHash:
          type: string
          maxLength: 255
          description: "The password of the User"
        emailAddress:
          type: string
          maxLength: 50
          description: "The email of the User"
        phoneNumber:
          type: string
          maxLength: 16
          description: "The phone number of the User"
          
    UserBasic:
      type: object
      properties:
        id:
          type: integer
          format: int64
        userName:
          type: string
          maxLength: 25
        emailAddress:
          type: string
          maxLength: 50
        phoneNumber:
          type: string
          maxLength: 16
          
    UserCredentials:
      type: object
      properties:
        userName:
          type: string
          maxLength: 25
        passwordHash:
          type: string
          maxLength: 255
        
    Bid:
      type: object
      properties:
        id: 
          type: integer
          format: int64
          description: "The unique identifier of Bids"
        itemId:
          type: integer
          format: int64
          description: "The id of the Auctionitem"
        userId:
          type: integer
          format: int64
          description: "The id of the User, who made the Bid"
        value:
          type: number
          format: double
          description: "The money offer in dollars"
        timeStamp:
          type: string
          format: date-time
          description: "The time, when the Bid was offered"
        isWinning:
          type: boolean
          description: "True if this Bid is winning the Auction"
    Category:
      type: object
      properties:
        id: 
          type: integer
          format: int64
          description: "The unique identifier of Categories"
        auctions: 
          type: array
          items:
            $ref: "#/components/schemas/Auction"          
            description: "The Auctions that fit into this Category"
        categoryName: 
          type: string
          maxLength: 50
          description: "The name of the Category"
    WatchId:
      type: object
      properties:
        auctionId:
          type: integer
          format: int64
          description: "The Auction part of the WatchId"
        userId:
          type: integer
          format: int64
          description: "The User part of the WatchId"
    Watch:
      type: object
      properties:
        id:
          $ref: "#/components/schemas/WatchId"
          description: "The unique identifier of Bids"
        auctionId:
          type: integer
          format: int64
          description: "The Auctions that are being watched by the User"
        userId:
          type: integer
          format: int64
          description: "The Users watching the Auction"
